<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Property - Uni Lodge</title>
    <link rel="stylesheet" href="styles/add-property.css">
</head>
<body>
    <header>
        <div><svg style="fill: var(--black);" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-0.5 -0.5 2001 1501"><rect width="0" height="0" x="0" y="0" id="background" stroke="transparent" fill="#ffffff"/><svg xml:space="preserve" width="1500" height="1125" data-version="2" data-id="lg_AR8IzeWLctFy1LyVda" viewBox="0 0 684 266" x="250" y="187.5"><rect width="100%" height="100%" fill="transparent"/><circle r="50" fill="#111" stroke="#fff" paint-order="stroke" transform="translate(136.66 133)scale(2.5822)"/><circle r="50" fill="#111" stroke="#fff" stroke-width="4" paint-order="stroke" transform="translate(136.66 133)scale(2.0717)"/><path fill="#fff" d="M166.178 160.298h-43.014a3.206 3.206 0 0 1-3.206-3.206v-20.305c0-.812.307-1.593.862-2.187l22.49-24.098-6.673-7.613-26.297 29.51v24.693a3.206 3.206 0 0 1-6.412 0v-25.914c0-.786.289-1.546.812-2.132l29.523-33.131c.611-.686 1.455-1.097 2.406-1.073a3.208 3.208 0 0 1 2.398 1.092l29.522 33.679c.513.584.795 1.336.795 2.114v25.365a3.206 3.206 0 0 1-3.206 3.206m-39.808-6.412h36.602v-20.954l-15.414-17.585-21.188 22.703z"/><path fill="#111" d="M323.654 174.28q-7.88 0-13.94-2.91-6.07-2.92-9.48-8.08-3.4-5.17-3.4-11.81v-38.29q0-1.89 1.23-3.08 1.23-1.19 3.04-1.19 1.88 0 3.07 1.19t1.19 3.08v38.29q0 4.43 2.34 7.83 2.33 3.4 6.47 5.33 4.15 1.93 9.48 1.93 5.16 0 9.14-1.93 3.98-1.93 6.23-5.33 2.26-3.4 2.26-7.83v-38.29q0-1.89 1.23-3.08 1.23-1.19 3.03-1.19 1.89 0 3.03 1.19 1.15 1.19 1.15 3.08v38.29q0 6.64-3.32 11.81-3.32 5.16-9.22 8.08-5.91 2.91-13.53 2.91"/><rect width="52.89" height="65.36" x="-26.45" y="-32.68" fill="none" rx="0" ry="0" transform="translate(323.78 142.1)"/><path fill="#111" d="M403.194 173.05q-1.81 0-3-1.19t-1.19-3v-20.17q0-4.67-1.72-7.62-1.72-2.96-4.63-4.39-2.91-1.44-6.68-1.44-3.45 0-6.24 1.4-2.78 1.39-4.42 3.73-1.64 2.34-1.64 5.37h-5.17q0-5.17 2.5-9.22 2.5-4.06 6.85-6.44 4.34-2.38 9.76-2.38 5.65 0 10.12 2.42 4.47 2.42 7.05 7.09 2.59 4.68 2.59 11.48v20.17q0 1.81-1.19 3t-2.99 1.19m-33.71 0q-1.8 0-2.99-1.19-1.19-1.19-1.19-3v-36.57q0-1.88 1.19-3.03t2.99-1.15q1.89 0 3.04 1.15 1.15 1.15 1.15 3.03v36.57q0 1.81-1.15 3t-3.04 1.19"/><rect width="42.07" height="45.35" x="-21.04" y="-22.68" fill="none" rx="0" ry="0" transform="translate(386.84 150.88)"/><path fill="#111" d="M426.234 172.96q-1.81 0-3-1.18-1.18-1.19-1.18-3v-36.49q0-1.88 1.18-3.03 1.19-1.15 3-1.15 1.88 0 3.03 1.15t1.15 3.03v36.49q0 1.81-1.15 3-1.15 1.18-3.03 1.18m0-52.15q-2.22 0-3.82-1.6-1.59-1.6-1.59-3.81t1.59-3.81q1.6-1.6 3.82-1.6 2.21 0 3.81 1.6t1.6 3.81q0 2.21-1.6 3.81t-3.81 1.6"/><rect width="10.82" height="62.97" x="-5.41" y="-31.48" fill="none" rx="0" ry="0" transform="translate(426.73 141.97)"/><path fill="#111" d="M456.653 172.96q-3.61 0-6.4-1.96-2.78-1.97-4.34-5.37-1.56-3.41-1.56-7.84v-44.77q0-1.8 1.15-2.95 1.15-1.15 2.95-1.15 1.8 0 2.95 1.15 1.15 1.15 1.15 2.95v44.77q0 3.04 1.15 5.01 1.15 1.96 2.95 1.96h2.05q1.64 0 2.66 1.15 1.03 1.15 1.03 2.95 0 1.81-1.56 2.96-1.56 1.14-4.02 1.14Z"/><rect width="18.04" height="64.04" x="-9.02" y="-32.02" fill="none" rx="0" ry="0" transform="translate(453.87 141.44)"/><path fill="#111" d="M488.474 173.29q-6.65 0-11.73-2.91t-8-8.03q-2.91-5.13-2.91-11.77 0-6.73 2.91-11.85 2.92-5.13 8-8.04 5.08-2.91 11.73-2.91 6.56 0 11.64 2.91 5.08 2.91 7.99 8.04 2.92 5.12 2.92 11.85 0 6.64-2.87 11.77-2.87 5.12-7.96 8.03-5.08 2.91-11.72 2.91m0-7.38q4.26 0 7.54-1.97 3.28-1.96 5.12-5.41 1.85-3.44 1.85-7.95t-1.85-8q-1.84-3.48-5.12-5.45-3.28-1.97-7.54-1.97-4.27 0-7.55 1.97-3.28 1.97-5.16 5.45-1.89 3.49-1.89 8t1.89 7.95q1.88 3.45 5.16 5.41 3.28 1.97 7.55 1.97"/><rect width="45.19" height="45.51" x="-22.59" y="-22.75" fill="none" rx="0" ry="0" transform="translate(488.93 151.03)"/><path fill="#111" d="M543.824 173.29q-6.4 0-11.53-2.99-5.12-2.99-8.11-8.16-3-5.17-3-11.64 0-6.48 2.75-11.61 2.75-5.12 7.5-8.11 4.76-3 10.75-3 4.83 0 8.93 2.01t6.89 5.45V113.1q0-1.88 1.19-3.03t2.99-1.15q1.89 0 3.04 1.15 1.15 1.15 1.15 3.03v37.4q0 6.47-3 11.64-2.99 5.17-8.07 8.16-5.09 2.99-11.48 2.99m0-7.38q4.18 0 7.46-2.01 3.28-2.01 5.16-5.53 1.89-3.53 1.89-7.87 0-4.43-1.89-7.88-1.88-3.44-5.16-5.45-3.28-2.01-7.46-2.01-4.1 0-7.43 2.01-3.32 2.01-5.24 5.45-1.93 3.45-1.93 7.88 0 4.34 1.93 7.87 1.92 3.52 5.24 5.53 3.33 2.01 7.43 2.01"/><rect width="45.19" height="64.37" x="-22.59" y="-32.19" fill="none" rx="0" ry="0" transform="translate(544.28 141.6)"/><path fill="#111" d="M599.824 173.29q-6.15 0-10.86-2.91-4.72-2.91-7.42-8.03-2.71-5.13-2.71-11.77 0-6.73 2.91-11.85 2.91-5.13 8-8.04 5.08-2.91 11.72-2.91 6.56 0 11.65 2.91 5.08 2.91 7.99 8.04 2.91 5.12 2.91 11.85h-4.84q0 6.64-2.5 11.77-2.5 5.12-6.84 8.03-4.35 2.91-10.01 2.91m1.48 18.29q-5.82 0-10.91-2.3-5.08-2.29-8.61-6.72-1.06-1.4-.78-2.87.29-1.48 1.6-2.38 1.48-.98 3.08-.66 1.6.33 2.58 1.64 2.21 2.79 5.58 4.35 3.36 1.56 7.62 1.56 3.94 0 7.26-1.89 3.32-1.88 5.29-5.57 1.97-3.69 1.97-9.02v-11.65l2.7-7.21 5.33 1.72v17.71q0 6.48-2.87 11.77-2.87 5.29-7.99 8.4-5.13 3.12-11.85 3.12m.16-25.67q4.27 0 7.55-1.97 3.28-1.96 5.12-5.41 1.85-3.44 1.85-7.95t-1.85-8q-1.84-3.48-5.12-5.45-3.28-1.97-7.55-1.97-4.26 0-7.54 1.97-3.28 1.97-5.17 5.45-1.88 3.49-1.88 8t1.88 7.95q1.89 3.45 5.17 5.41 3.28 1.97 7.54 1.97"/><rect width="45.18" height="63.8" x="-22.59" y="-31.9" fill="none" rx="0" ry="0" transform="translate(601.92 160.18)"/><path fill="#111" d="M657.554 173.29q-6.81 0-12.1-2.91-5.28-2.91-8.28-8.03-2.99-5.13-2.99-11.77 0-6.73 2.83-11.85 2.83-5.13 7.83-8.04 5-2.91 11.48-2.91 6.4 0 10.99 2.83t7.01 7.79q2.42 4.96 2.42 11.44 0 1.56-1.07 2.58-1.06 1.03-2.7 1.03h-33.05v-6.56h32.8l-3.36 2.29q-.08-4.1-1.64-7.33-1.56-3.24-4.43-5.13-2.87-1.89-6.97-1.89-4.67 0-8 2.05-3.32 2.05-5.04 5.62-1.72 3.57-1.72 8.08t2.05 8.03q2.05 3.53 5.66 5.58 3.61 2.05 8.28 2.05 2.54 0 5.21-.94 2.66-.95 4.3-2.18 1.23-.9 2.67-.94 1.43-.04 2.5.86 1.39 1.23 1.47 2.71.09 1.47-1.31 2.54-2.79 2.21-6.93 3.61-4.14 1.39-7.91 1.39"/><rect width="42.56" height="45.51" x="-21.28" y="-22.75" fill="none" rx="0" ry="0" transform="translate(655.96 151.03)"/><circle r="10.3" fill="#fff" transform="translate(425.3 117.27)"/><path fill="#111" d="M426.226 106.875c-4.07 0-7.368 3.081-7.368 6.883 0 3.8 4.973 11.978 7.368 11.978 2.394 0 7.368-8.177 7.368-11.978 0-3.802-3.3-6.883-7.368-6.883m0 9.99c-1.837 0-3.328-1.39-3.328-3.107s1.49-3.108 3.328-3.108a3.327 3.108 0 0 1 3.327 3.108c0 1.717-1.49 3.108-3.327 3.108"/></svg></svg></div>
        <div class="side-bar">
            <div><svg onclick="hideSidebar()" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: var(--black);"><path d="M5.002 21h14c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2h-14c-1.103 0-2 .897-2 2v6.001H10V7l6 5-6 5v-3.999H3.002V19c0 1.103.897 2 2 2z"></path></svg></div>
            <div>
            <nav>
                <ul>
                    <a href="index.html" class="nav-link"><li>Home</li></a>
                    <a href="rooms.html" class="nav-link"><li>Rooms</li></a>
                    <a href="about.html" class="nav-link"><li>About</li></a>
                    <a href="contact.html" class="nav-link"><li>Contact</li></a>
                    <li><span id="pronames"></span></li>
                </ul>
            </nav></div>
        </div>
        <div class="nav-bar">
            <nav>
                <ul >
                    <li><a href="index.html" class="nav-link">Home</a></li>
                    <li><a href="rooms.html" class="nav-link">Rooms</a></li>
                    <li><a href="about.html" class="nav-link">About</a></li>
                    <li><a href="contact.html" class="nav-link">Contact</a></li>
                    </li><span id="proname"></span></span></li>
                </ul>
            </nav>
        </div>
        <div class="header-icons">
            <a href="login.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: var(--black);"><path d="M7.5 6.5C7.5 8.981 9.519 11 12 11s4.5-2.019 4.5-4.5S14.481 2 12 2 7.5 4.019 7.5 6.5zM20 21h1v-1c0-3.859-3.141-7-7-7h-4c-3.86 0-7 3.141-7 7v1h17z"></path></svg></a>
            <svg class="menu-icon" onclick="showSidebar()" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: var(--black);"><path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"></path></svg>
        </div>
    </header>
    
    <main class="add-property">
        <div class="wrapper">
            <div class="property-form">
                <h1>Add Your Property</h1>
                <p class="subtitle">List your accommodation for students</p>
                
                <form id="propertyForm">
                    <input type="hidden" id="owner_id" name="owner_id" value="">

                    <div class="input-field">
                        <input type="text" name="title" placeholder="Property Title (e.g., Cozy Room Near UOM)" required>
                    </div>
                    
                    <div class="input-field">
                        <textarea name="description" placeholder="Describe your property..." rows="3"></textarea>
                    </div>

                    <div class="input-field">
                        <select name="property_type" required>
                            <option value="">Select Property Type</option>
                            <option value="room">Single Room</option>
                            <option value="annex">Annex</option>
                        </select>
                    </div>

                    <div class="input-field">
                        <input type="number" name="price" placeholder="Monthly Rent (LKR)" min="1" required>
                    </div>

                    <div class="input-field">
                        <input type="number" name="latitude" placeholder="Latitude" step="any" required>
                    </div>

                    <div class="input-field">
                        <input type="number" name="longitude" placeholder="Longitude" step="any" required>
                    </div>

                    <div class="input-field">
                        <input type="text" name="address" placeholder="Full Address" required>
                    </div>

                    <div class="input-field">
                        <input type="number" name="capacity" placeholder="Capacity (Number of People)" min="1" max="10">
                    </div>

                    <div class="input-field">
                        <input type="number" name="distance_from_university" placeholder="Distance from UOM (km)" step="0.1" min="0">
                    </div>

                    <!---
                    <div class="input-field" style="border: 0px;">
                        <label for="image"  style="border: 0px;">Image</label>
                        <input type="file"  style="border: 0px;" name="image" id="image" accept="image/*" required>
                    </div>
                    --->

                    <div class="amenities-selection">
                        <label class="selection-title">Available Amenities:</label>
                        <div class="amenities-group">
                            <div class="amenity-option">
                                <input type="checkbox" id="wifi" name="has_wifi">
                                <label for="wifi" class="amenity-label">
                                    <div class="amenity-content">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="amenity-icon">
                                            <path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"/>
                                            <path d="M12 6c-3.309 0-6 2.691-6 6h2c0-2.206 1.794-4 4-4s4 1.794 4 4h2c0-3.309-2.691-6-6-6z"/>
                                            <path d="M12 10c-1.103 0-2 .897-2 2h2v-2h2c0-1.103-.897-2-2-2z"/>
                                        </svg>
                                        <span>WiFi Internet</span>
                                    </div>
                                </label>
                            </div>
                            
                            <div class="amenity-option">
                                <input type="checkbox" id="ac" name="has_ac">
                                <label for="ac" class="amenity-label">
                                    <div class="amenity-content">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="amenity-icon">
                                            <path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"/>
                                            <path d="M8 12h8v2H8z"/>
                                            <path d="M10 8h4v2h-4z"/>
                                            <path d="M10 16h4v2h-4z"/>
                                        </svg>
                                        <span>Air Conditioning</span>
                                    </div>
                                </label>
                            </div>
                            
                            <div class="amenity-option">
                                <input type="checkbox" id="kitchen" name="has_kitchen">
                                <label for="kitchen" class="amenity-label">
                                    <div class="amenity-content">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="amenity-icon">
                                            <path d="M19 3H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2zM5 5h14v2H5V5zm0 14V9h14l.002 10H5z"/>
                                            <path d="M7 11h2v6H7zm4 0h2v6h-2z"/>
                                        </svg>
                                        <span>Kitchen Access</span>
                                    </div>
                                </label>
                            </div>
                            
                            <div class="amenity-option">
                                <input type="checkbox" id="washing" name="has_washing_machine">
                                <label for="washing" class="amenity-label">
                                    <div class="amenity-content">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="amenity-icon">
                                            <circle cx="12" cy="12" r="3"/>
                                            <path d="M12 1a11 11 0 1 0 11 11A11 11 0 0 0 12 1zm0 20a9 9 0 1 1 9-9 9 9 0 0 1-9 9z"/>
                                        </svg>
                                        <span>Washing Machine</span>
                                    </div>
                                </label>
                            </div>
                            
                            <div class="amenity-option">
                                <input type="checkbox" id="furniture" name="has_furniture">
                                <label for="furniture" class="amenity-label">
                                    <div class="amenity-content">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="amenity-icon">
                                            <path d="M19 13V7a1 1 0 0 0-1-1H6a1 1 0 0 0-1 1v6H3v4a1 1 0 0 0 1 1h1v2h2v-2h10v2h2v-2h1a1 1 0 0 0 1-1v-4h-2zM7 8h10v5H7V8z"/>
                                        </svg>
                                        <span>Furnished</span>
                                    </div>
                                </label>
                            </div>
                            
                            <div class="amenity-option">
                                <input type="checkbox" id="bathroom" name="has_attached_bathroom">
                                <label for="bathroom" class="amenity-label">
                                    <div class="amenity-content">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="amenity-icon">
                                            <path d="M21 10H7V7c0-1.103.897-2 2-2s2 .897 2 2h2c0-2.206-1.794-4-4-4S5 4.794 5 7v3H3a1 1 0 0 0-1 1v2c0 2.606 1.674 4.823 4 5.65V22h2v-3h8v3h2v-3.35c2.326-.827 4-3.044 4-5.65v-2a1 1 0 0 0-1-1z"/>
                                        </svg>
                                        <span>Attached Bathroom</span>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="input-field">
                        <select name="available" required>
                            <option value="1">Available Now</option>
                            <option value="0">Not Available</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="btn">Add Property</button>
                    
                    <div class="back-link">
                        <p><a href="rooms.html">← Back to Properties</a></p>
                    </div>
                </form>
            </div>
        </div>
    </main>
    
    <footer>
        <div class="bottom-footer">
            <p class="fot1">© 2025 Unilodge. All Right Reserved.</p>
            <p class="fot2">Designed by Team Unilodge. Powered by AWS</p>
        </div>
    </footer>
    
    <script>
        function showSidebar() {
            document.querySelector('.side-bar').style.display = 'flex';
            document.querySelector('.side-bar').style.right = '0';
        }
        
        function hideSidebar() {
            document.querySelector('.side-bar').style.right = '-100%';
            setTimeout(() => {
                document.querySelector('.side-bar').style.display = 'none';
            }, 300);
        }
        
        function darkMode() {
            document.body.classList.toggle('dark-mode');
        }

        document.getElementById('owner_id').value = 1;

document.getElementById('propertyForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    const submitBtn = this.querySelector('.btn');
    const originalText = submitBtn.textContent;

    submitBtn.disabled = true;
    submitBtn.textContent = 'Adding Property...';
    submitBtn.style.opacity = '0.7';

    const formData = new FormData(this);

    // Convert form fields
    const data = {
        title: formData.get('title'),
        address: formData.get('address'),
        property_type: formData.get('property_type'),
        price: Number(formData.get('price')),
        latitude: parseFloat(formData.get('latitude')),
        longitude: parseFloat(formData.get('longitude')),
        capacity: Number(formData.get('capacity')),
        available: formData.get('available') === "1", // or true/false if checkbox
        owner_id: Number(formData.get('owner_id')),
        description: formData.get('description'),
        distance_from_university: parseFloat(formData.get('distance_from_university')),
        image_path: formData.get('image_path') || "uploads/default.jpg", // change as needed
        amenities: {
            has_wifi: formData.has('has_wifi'),
            has_ac: formData.has('has_ac'),
            has_kitchen: formData.has('has_kitchen'),
            has_washing_machine: formData.has('has_washing_machine'),
            has_hot_water: formData.has('has_hot_water'),
            has_furniture: formData.has('has_furniture'),
            has_attached_bathroom: formData.has('has_attached_bathroom'),
            has_parking: formData.has('has_parking')
        }
    };

    try {
        const res = await fetch('https://webpojja.pasgorasa.site/api/add-property', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        });

        const text = await res.text();

        if (res.ok) {
            submitBtn.textContent = 'Property Added!';
            submitBtn.style.backgroundColor = '#28a745';
            alert("Property added successfully: " + text);

            setTimeout(() => {
                window.location.href = "rooms.html";
            }, 1500);
        } else {
            throw new Error(text);
        }
    } catch (err) {
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
        submitBtn.style.opacity = '1';
        submitBtn.style.backgroundColor = '';

        alert('Error adding property: ' + err.message);
    }
});



        
        document.querySelectorAll('input[required], select[required], textarea[required]').forEach(input => {
            input.addEventListener('blur', function() {
                if (this.value.trim() === '') {
                    this.style.borderColor = '#dc3545';
                } else {
                    this.style.borderColor = '#28a745';
                }
            });
            
            input.addEventListener('input', function() {
                this.style.borderColor = '';
            });
        });
    </script>
    <script>
  document.addEventListener('DOMContentLoaded', () => {
    const username = localStorage.getItem('username');
    const proname = document.getElementById('proname');
    const pronames = document.getElementById('pronames');

    if (proname) {
      if (username) {
        proname.innerHTML = `
          <a href="profile.html" class="nav-link">Hello, ${username}</a>
        `;
        pronames.innerHTML = `
          <a href="profile.html" class="nav-link">Hello, ${username}</a>
        `;
      } else {
        proname.innerHTML = `
          <a href="login.html" class="nav-link">Login</a>
        `;
        pronames.innerHTML = `
          <a href="login.html" class="nav-link">Login</a>
        `;
      }
    }
  });
</script>
</body>
</html>
